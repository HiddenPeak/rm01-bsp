# BSPæ¶æ„é‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ“Š é‡æ„æ¦‚è¿°

æœ¬æ¬¡é‡æ„å®Œæˆäº†BSPç³»ç»ŸçŠ¶æ€ç®¡ç†æ¶æ„çš„æœ€ç»ˆç®€åŒ–ï¼Œç§»é™¤äº†å†—ä½™çš„å…¼å®¹æ€§åŒ…è£…å±‚ï¼Œå»ºç«‹äº†æ¸…æ™°çš„åˆ†å±‚æ¶æ„ã€‚

**é‡æ„æ—¥æœŸ**: 2025å¹´6æœˆ10æ—¥  
**é‡æ„ç±»å‹**: æ¶æ„æ¸…ç†ä¸ç®€åŒ–  
**å½±å“èŒƒå›´**: BSPç³»ç»ŸçŠ¶æ€ç®¡ç†æ¨¡å—

## ğŸ¯ é‡æ„ç›®æ ‡

1. **ç§»é™¤å†—ä½™ä»£ç ** - åˆ é™¤ä¸å¿…è¦çš„ `bsp_system_state` å…¼å®¹æ€§åŒ…è£…å±‚
2. **ç®€åŒ–æ¶æ„** - å»ºç«‹æ¸…æ™°çš„åˆ†å±‚è®¾è®¡
3. **ç»Ÿä¸€æ¥å£ä½¿ç”¨** - æ‰€æœ‰ä»£ç ç›´æ¥ä½¿ç”¨æ–°æ¶æ„æ¥å£
4. **å‡å°‘ä¾èµ–å¤æ‚åº¦** - ç®€åŒ–æ¨¡å—é—´çš„ä¾èµ–å…³ç³»

## ğŸ”§ é‡æ„å†…å®¹

### ç§»é™¤çš„æ–‡ä»¶
- `src/bsp_system_state.c` - å…¼å®¹æ€§åŒ…è£…å®ç°
- `include/bsp_system_state.h` - å…¼å®¹æ€§åŒ…è£…å¤´æ–‡ä»¶

### æ›´æ–°çš„æ–‡ä»¶
- `CMakeLists.txt` - ç§»é™¤ `bsp_system_state.c` ç¼–è¯‘ä¾èµ–
- `src/bsp_board.c` - æ›´æ–°æ¶æ„è¯´æ˜æ³¨é‡Š
- `README.md` - æ›´æ–°é¡¹ç›®ç»“æ„å’Œæ¥å£è¯´æ˜

## ğŸ—ï¸ æœ€ç»ˆæ¶æ„

### åˆ†å±‚è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               åº”ç”¨å±‚                    â”‚
â”‚         (main.c, bsp_board.c)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            BSPæœåŠ¡å±‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ bsp_state_mgr   â”‚ â”‚ bsp_display_ctrlâ”‚ â”‚
â”‚  â”‚ (çŠ¶æ€æ£€æµ‹ç®¡ç†)  â”‚ â”‚ (æ˜¾ç¤ºæ§åˆ¶)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ bsp_net_anim    â”‚                     â”‚
â”‚  â”‚ (ç½‘ç»œçŠ¶æ€ç›‘æ§)  â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            åº•å±‚ç»„ä»¶                     â”‚
â”‚  network_monitor, led_matrix,           â”‚
â”‚  bsp_power, bsp_ws2812, etc.           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—èŒè´£

#### 1. bsp_state_manager (çŠ¶æ€ç®¡ç†å™¨)
**æ–‡ä»¶**: `src/bsp_state_manager.c`
**èŒè´£**:
- ç³»ç»ŸçŠ¶æ€æ£€æµ‹ä¸åˆ†æ
- ç½‘ç»œè¿æ¥çŠ¶æ€ç›‘æ§
- æ¸©åº¦çŠ¶æ€è¯„ä¼°
- è®¡ç®—è´Ÿè½½æ£€æµ‹
- çŠ¶æ€å˜åŒ–é€šçŸ¥æœºåˆ¶

#### 2. bsp_display_controller (æ˜¾ç¤ºæ§åˆ¶å™¨)
**æ–‡ä»¶**: `src/bsp_display_controller.c`
**èŒè´£**:
- LEDåŠ¨ç”»é€‰æ‹©ä¸åˆ‡æ¢
- çŠ¶æ€åˆ°åŠ¨ç”»çš„æ˜ å°„
- è‡ªåŠ¨/æ‰‹åŠ¨æ˜¾ç¤ºæ¨¡å¼ç®¡ç†
- æ˜¾ç¤ºç»Ÿè®¡ä¸è°ƒè¯•

#### 3. bsp_network_animation (ç½‘ç»œåŠ¨ç”»æ§åˆ¶å™¨)
**æ–‡ä»¶**: `src/bsp_network_animation.c`
**èŒè´£**:
- ç½‘ç»œçŠ¶æ€å˜åŒ–ç›‘å¬
- ä¸çŠ¶æ€ç®¡ç†å™¨çš„äº‹ä»¶é›†æˆ
- å…¼å®¹æ€§æ¥å£æä¾›

## ğŸ”„ æ¥å£å˜åŒ–

### ç›´æ¥ä½¿ç”¨æ–°æ¶æ„æ¥å£

**çŠ¶æ€ç®¡ç†**:
```c
// æ—§æ–¹å¼ (å·²ç§»é™¤)
bsp_system_state_init();
bsp_system_state_start_monitoring();

// æ–°æ–¹å¼ (ç›´æ¥ä½¿ç”¨)
bsp_state_manager_init();
bsp_state_manager_start_monitoring();
```

**æ˜¾ç¤ºæ§åˆ¶**:
```c
// æ–°å¢æ¥å£
bsp_display_controller_init(NULL);
bsp_display_controller_start();
bsp_display_controller_set_animation(DISPLAY_ANIM_STARTUP);
```

## ğŸ‰ é‡æ„æ•ˆæœ

### 1. ä»£ç ç®€åŒ–
- **åˆ é™¤æ–‡ä»¶**: 2ä¸ª (bsp_system_state.c/.h)
- **ä»£ç è¡Œæ•°å‡å°‘**: ~150è¡Œ
- **ç¼–è¯‘ä¾èµ–å‡å°‘**: 1ä¸ªæºæ–‡ä»¶

### 2. æ¶æ„æ¸…æ™°åŒ–
- **æ¶ˆé™¤åŒ…è£…å±‚**: ç›´æ¥ä½¿ç”¨æ ¸å¿ƒæ¥å£
- **èŒè´£åˆ†ç¦»**: çŠ¶æ€æ£€æµ‹ä¸æ˜¾ç¤ºæ§åˆ¶å®Œå…¨è§£è€¦
- **ä¾èµ–ç®€åŒ–**: å‡å°‘æ¨¡å—é—´çš„é—´æ¥ä¾èµ–

### 3. ç»´æŠ¤æ€§æå‡
- **æ¥å£ç»Ÿä¸€**: æ‰€æœ‰ä»£ç ä½¿ç”¨ç›¸åŒçš„æ¥å£è§„èŒƒ
- **æ–‡æ¡£ä¸€è‡´**: ç§»é™¤äº†æ··æ·†çš„å…¼å®¹æ€§è¯´æ˜
- **æ‰©å±•æ€§å¥½**: æ–°åŠŸèƒ½å¯ä»¥ç›´æ¥åœ¨æ ¸å¿ƒæ¨¡å—ä¸­æ·»åŠ 

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### å¯¹äºæ–°ä»£ç 
ç›´æ¥ä½¿ç”¨æ ¸å¿ƒæ¥å£:
```c
#include "bsp_state_manager.h"
#include "bsp_display_controller.h"

// çŠ¶æ€ç®¡ç†
bsp_state_manager_init();
bsp_state_manager_start_monitoring();

// æ˜¾ç¤ºæ§åˆ¶
bsp_display_controller_init(NULL);
bsp_display_controller_start();
```

### è¿ç§»å»ºè®®
å¦‚æœæœ‰ä½¿ç”¨æ—§æ¥å£çš„ä»£ç ï¼Œè¯·æŒ‰ä»¥ä¸‹æ–¹å¼è¿ç§»:

| æ—§æ¥å£ | æ–°æ¥å£ |
|--------|--------|
| `bsp_system_state_init()` | `bsp_state_manager_init()` + `bsp_display_controller_init()` |
| `bsp_system_state_start_monitoring()` | `bsp_state_manager_start_monitoring()` + `bsp_display_controller_start()` |
| `bsp_system_state_get_current()` | `bsp_state_manager_get_current_state()` |
| `bsp_system_state_print_status()` | `bsp_state_manager_print_status()` + `bsp_display_controller_print_status()` |

## ğŸ” éªŒè¯æ­¥éª¤

### ç¼–è¯‘éªŒè¯
```bash
cd rm01-bsp
idf.py build
```

### åŠŸèƒ½éªŒè¯
1. **çŠ¶æ€æ£€æµ‹** - éªŒè¯ç½‘ç»œçŠ¶æ€æ£€æµ‹åŠŸèƒ½
2. **æ˜¾ç¤ºæ§åˆ¶** - éªŒè¯LEDåŠ¨ç”»åˆ‡æ¢åŠŸèƒ½
3. **äº‹ä»¶å“åº”** - éªŒè¯çŠ¶æ€å˜åŒ–è§¦å‘æ˜¾ç¤ºæ›´æ–°

## âœ… é‡æ„æ£€æŸ¥æ¸…å•

- [x] ç§»é™¤å…¼å®¹æ€§æ–‡ä»¶ (bsp_system_state.c/.h)
- [x] æ›´æ–°ç¼–è¯‘é…ç½® (CMakeLists.txt)
- [x] éªŒè¯ç¼–è¯‘æˆåŠŸ
- [x] æ›´æ–°é¡¹ç›®æ–‡æ¡£ (README.md)
- [x] æ›´æ–°æ¶æ„è¯´æ˜æ³¨é‡Š
- [x] åˆ›å»ºé‡æ„å®Œæˆæ–‡æ¡£

## ğŸ“ åç»­è®¡åˆ’

### è¿‘æœŸ
1. **æ€§èƒ½ä¼˜åŒ–** - ç›‘æ§æ–°æ¶æ„çš„è¿è¡Œæ€§èƒ½
2. **åŠŸèƒ½æµ‹è¯•** - å…¨é¢æµ‹è¯•æ‰€æœ‰çŠ¶æ€ç®¡ç†åŠŸèƒ½
3. **æ–‡æ¡£å®Œå–„** - è¡¥å……æ–°æ¶æ„çš„ä½¿ç”¨ç¤ºä¾‹

### ä¸­æœŸ
1. **APIæ ‡å‡†åŒ–** - è¿›ä¸€æ­¥è§„èŒƒæ¥å£å‘½åå’Œå‚æ•°
2. **é”™è¯¯å¤„ç†** - å¢å¼ºé”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
3. **å•å…ƒæµ‹è¯•** - ä¸ºæ ¸å¿ƒæ¨¡å—æ·»åŠ å•å…ƒæµ‹è¯•

---

**é‡æ„å®Œæˆæ—¶é—´**: 2025å¹´6æœˆ10æ—¥  
**æ¶æ„ç‰ˆæœ¬**: v3.0 (åˆ†å±‚æ¨¡å—åŒ–)  
**çŠ¶æ€**: âœ… é‡æ„å®Œæˆï¼Œæ¶æ„æ¸…æ™°ï¼Œæ¥å£ç»Ÿä¸€
